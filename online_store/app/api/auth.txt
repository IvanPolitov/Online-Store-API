from fastapi import APIRouter, Depends
from fastapi.security import OAuth2PasswordRequestForm
from sqlalchemy.orm import Session


from ..db.base import get_db
from ..db.models import User

auth_router = APIRouter(prefix='/auth', tags=['auth'])


@auth_router.post("/login")
async def login(
    db: Session = Depends(get_db),
    credentials: OAuth2PasswordRequestForm = Depends()
):
    user = db.query(User).filter(credentials.username == User.username).first()

    return {"message": "Welcome"}


@auth_router.get("/")
async def protected():
    return {"message": "protected"}
